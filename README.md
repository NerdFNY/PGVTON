# PGVTON â€” Official Implementation
Hi,this is our new work about virtual try-on: PG-VTON: A Novel Image-Based Virtual Try-On Method via Progressive Inference Paradigm.

This paper has been published on TMM 2024 and is available [[here]](URL 'https://ieeexplore.ieee.org/document/10400859').

## Demo
![](https://github.com/NerdFNY/PGVTON/blob/main/fig1.png)
![](https://github.com/NerdFNY/PGVTON/blob/main/fig2.png)


## Requirements
```
conda create -n pgvton python=3.7
conda activate pgvton
conda install pytorch==1.10.1 torchvision==0.11.2 torchaudio==0.10.1 cudatoolkit=11.3 -c pytorch -c conda-forge
pip install -r requirements.txt
```

## Dataset
We use the [processed version](URL 'https://github.com/sergeywong/cp-vton') of [VITON](URL 'https://github.com/xthan/VITON') dataset.

The priors of human image parser and pose can be generated by [Grapy-ML](URL 'https://github.com/Charleshhy/Grapy-ML') and [Densepose](URL 'https://github.com/facebookresearch/detectron2/tree/main/projects/DensePose')

The dataset structure is recommended as follows. For the testing dataset, you can randomly shuffle the cloth order.
```
|+-cloth
|    +-000001_1.jpg
|+-cloth-mask
|    +-000001_1.jpg
|+-densepose
|    +-000001_0.npy
|+-image
|    +-000001_0.jpg
|+-image-parse
|    +-sg
|        +-000001_0.png 
|    +-sg_vis
|        +-000001_0.png 
```

## Train
```
python -main.py --data_dir your_dir --mode train --submodel TPIM --vis_dir TPIM_vis --checkpoint_dir TPIM_checkpoint --loss_dir TPIM_ loss --g_lr 0.0001
python -main.py --data_dir your_dir --mode train --submodel PTM --vis_dir PTM_vis --checkpoint_dir PTM_checkpoint --loss_dir PTM_ loss --g_lr 0.0002
python -main.py --data_dir your_dir --mode train --submodel RSIM --vis_dir RSIM_vis --checkpoint_dir RSIM_checkpoint --loss_dir RSIM_ loss --g_lr 0.00001
```

## Test
```
python -main.py --data_dir your_dir --mode eval --submodel TPIM 
python -main.py --data_dir your_dir --mode eval --submodel PTM 
python -main.py --data_dir your_dir --mode eval --submodel RSIM 
python -composition.py
```

## Citation
Please consider citing our work if you find it useful for your research:
```
@ARTICLE{10400859,
  author={Fang, Naiyu and Qiu, Lemiao and Zhang, Shuyou and Wang, Zili and Hu, Kerui},
  journal={IEEE Transactions on Multimedia}, 
  title={PG-VTON: A Novel Image-Based Virtual Try-On Method via Progressive Inference Paradigm}, 
  year={2024},
  volume={26},
  number={},
  pages={6595-6608},
  keywords={Clothing;Skin;Task analysis;Shape;Training;Deformation;Transformers;Virtual try-on;PG-VTON;Garment warping;Skin inpainting;Vision Transformer},
  doi={10.1109/TMM.2024.3354622}}
```